trigger: 
  branches:
    include:
    - '*'
pool: cholpona

resources:
  repositories: 
  - repository: ag-fraud-advisor
    type: git 
    name: ag-fraud-advisor/ag-fraud-advisor
    ref: refs/heads/Test
stages: 
- stage: sw
  jobs:
  - job: sw
    steps:
    - script: |
        git config user.email "$(Build.RequestedForEmail)"
        git config user.name "$(Build.RequestedFor)"
        current_branch=$(echo $(Build.SourceBranch) | awk -F '/' '{print $3}')
        # git fetch -a
        # git checkout origin/main
        # git pull origin main
        # git checkout -b '$(current_branch)'
        # git merge origin main
        # echo $current_branch
        #2 git checkout main
        # git pull origin main
        # git merge origin/$current_branch
        # git push origin main
        git config pull.rebase true  
        git checkout $current_branch
        git pull origin main
        git checkout main
        git pull
        git merge --no-ff --no-commit $current_branch
  
